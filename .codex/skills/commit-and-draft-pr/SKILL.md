---
name: commit-and-draft-pr
description: 変更内容を確認してコミットし、ドラフトPRを作成する一連のGit/ghワークフローを実行する。git status/diff/log確認、適切なgit add、命令形コミットメッセージ作成、push、gh pr create --draft を含む作業で使用する。
---

# Commit and Draft PR

## 事前確認

- `git status` と `git diff` で変更を把握する
- `git log --oneline -5` で直近の履歴を把握する
- `git branch` で現在ブランチを確認する
- `main` の場合は feature ブランチを作成する

## ステージング

- 必要な変更のみ `git add` する
- 不要なファイル（例: `hogehoge`, `*.json`, `prompt.md`, `testcase.md` など）は除外する

## コミットメッセージ

- タイトルは命令形・72文字以内
- 本文は以下を含める:
  - 変更内容（何を変更したか）
  - 変更理由（なぜ変更したか）
  - 技術的な詳細（どのように変更したか）
  - 注意事項（影響範囲、レビュー時の確認ポイント）

## コミット実行

- 例（内容は実際の変更に合わせて調整する）:

  ```bash
  git commit -m "$(cat <<'EOF'
  タイトル（72文字以内）

  ## 変更内容
  - 変更点1
  - 変更点2

  ## 変更理由
  理由の説明

  ## 技術的な詳細
  詳細な説明

  ## 注意事項
  レビュー時の確認ポイントなど
  EOF
  )"
  ```

## プッシュ

- `git push -u origin <ブランチ名>`
- リモートに同名ブランチがある場合は `--force-with-lease` を検討する
- push 前に対象ブランチを再確認する

## ドラフトPR作成

- `gh pr create --draft --base main --head <ブランチ名> --title "<タイトル>" --body "<本文>"`
- 本文はコミット本文をベースにし、変更内容・理由・技術的詳細・注意事項を反映する
- 自動生成ツールの出力は必ず目視チェックしてから送信する

## 注意

- `gh` が未ログインの場合は `gh auth status` を確認し、必要ならログインする
- 既存のPRテンプレートがある場合は適宜整形する
